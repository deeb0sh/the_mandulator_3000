import{i as A,_ as g,c as f,e as l,a as r,b as d,w,r as c,f as k,o as u}from"./index-DnwhrkoJ.js";import{_ as v}from"./logozbs-BIZfnIXH.js";async function y(){return(await(await A.load()).get()).visitorId}class i extends Error{}i.prototype.name="InvalidTokenError";function C(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,n)=>{let s=n.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function B(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return C(e)}catch{return atob(e)}}function D(t,e){if(typeof t!="string")throw new i("Invalid token specified: must be a string");e||(e={});const n=e.header===!0?0:1,s=t.split(".")[n];if(typeof s!="string")throw new i(`Invalid token specified: missing part #${n+1}`);let o;try{o=B(s)}catch(a){throw new i(`Invalid token specified: invalid base64 for part #${n+1} (${a.message})`)}try{return JSON.parse(o)}catch(a){throw new i(`Invalid token specified: invalid json for part #${n+1} (${a.message})`)}}const R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqUlEQVR4nO2Zy04UURCGPyfORnCJK8WNN3SnrLytFVYKT4GsjMGM4QE0iBuNlyCuEDcoIMa9opHgG0D0DdwKLLTNSWqSsnLOTI9d7cyi/6STmZ46f1V11+2cgQoVKlSo0GM4CowCk8BtucLnEWCQHsUZYBb4DmRtrm/ADDBED+AUsAr8zmG4vcKaZeBkNwyvAdPAXsSwn8AHYAF4INeC3NuJyO8CDeH8L+gD3kcMWQGuy++t1o4BbyPr19qsdTP+s1H8BTj/D1wXgA3D9alMJ2qRJ/8I2F+Asw48jryJUsJp2ii66ch9y3CHnHDFCUm2poKH3gr4+03seVenVRPzRcKmVThtKj2vPZuUrvOphD0EDOfgGxbZGC4pPb+8mt19UypjCAb9EJm5RBLW5LdMZAcSXGtK3z0PB/R4cC0hc84k4bxxoib3tMzZBNeYktkuavyg6bCtavRcwomY8UE2hX7TsQ8XcWBUEYVRoBVihs4n7rWr8x+V/NUiDkwqopc55GNOdGp8wKJaM0EB3FFEYQTOg32R7tqJ8bZwNLwcCKR5HXgSceBFBw7Mejlwo0sh9MorhLqVxOteSazL6I6UuLLL6EEzdxUqo8getkkWNixlN7JxJbOFA2YUYdhJlT1KvFP67no4cNoMcxcTcgMtnqp9WynjL5thLhwauGBZEW/I6OuNOvBV6VnyJD9uEus5/niq+HfLOG5pmCQM20AvTBnu8N0dNTOrZ9Jxi4RTHXhmOFekm5eCA3L0oRVuyk6qU4SE1TGfyRQadJSKvsibaJbY8TbNrl9kdKnM1JMv3XgdTg2T2Lpjr8vs1DxaXJR7KfmpMsOm3XHLG6nZWYdXWBNK5TF6AEOyAd/OYfiWdFi3JuWNIzJBTqg/OMLnKx6DWYUKFSpUwBN/ADytcW875BNbAAAAAElFTkSuQmCC",E={name:"m3000",data(){return{token:null,isValidating:!0,username:null,roleID:null,inCode:null}},async mounted(){await this.sessionValid()},methods:{checkRole3(t){return t===3},checkRole2(t){return t===2},checkRole1(t){return t===1},checkRole0(t){return t===0},async sessionValid(){try{const t=localStorage.getItem("jwt");if(!t){this.$router.push("/");return}const e=await y();if((await(await fetch("/auth/login",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`,"X-Fingerprint":e}})).json()).message==="valid"){this.token=t,this.isValidating=!1;const o=D(t);this.username=o.user,this.roleID=o.role}else localStorage.removeItem("jwt"),this.$router.push("/")}catch{this.$router.push("/")}},logOut(){confirm("Вы уверены, что хотите выйти?")&&(localStorage.removeItem("jwt"),this.$router.push("/"))}}},N={key:0,class:"main"},b={class:"header"},I={class:"nav"},T={class:"nav"},L={class:"container"};function U(t,e,n,s,o,a){const p=c("RouterLink"),m=c("invite"),h=c("WG");return o.isValidating===!1?(u(),f("div",N,[r("div",b,[r("div",I,[d(p,{to:"/"},{default:w(()=>e[1]||(e[1]=[r("img",{class:"logo",src:v,width:"80"},null,-1)])),_:1}),e[2]||(e[2]=r("span",{class:"header-text"},[r("i",null," DarkSurf.ru ")],-1))]),r("div",T,[r("a",{href:"#",onClick:e[0]||(e[0]=V=>a.logOut())},e[3]||(e[3]=[r("img",{src:R},null,-1)]))])]),r("div",L,[a.checkRole3(o.roleID)||a.checkRole2(o.roleID)||a.checkRole1(o.roleID)?(u(),k(m,{key:0})):l("",!0),d(h)]),e[4]||(e[4]=r("div",null,null,-1))])):l("",!0)}const J=g(E,[["render",U],["__scopeId","data-v-0386587a"]]);export{J as default};
