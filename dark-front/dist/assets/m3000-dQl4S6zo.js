import{i as g,_ as k,c as v,e as a,a as o,b as i,w,r as n,f as c,j as y,o as l}from"./index-BF7uNzRn.js";import{_ as I}from"./logozbs-BIZfnIXH.js";import{_ as R}from"./exit2-yiskTQzU.js";async function V(){return(await(await g.load()).get()).visitorId}const D={name:"m3000",data(){return{token:null,isValidating:!0,username:null,roleID:null,inCode:null}},async mounted(){document.documentElement.style.overflow="auto",await this.sessionValid()},methods:{checkRole3(e){return e===3},checkRole2(e){return e===2},checkRole1(e){return e===1},checkRole0(e){return e===0},async sessionValid(){try{const e=localStorage.getItem("jwt");if(!e){this.$router.push("/");return}const t=await V();if((await(await fetch("/auth/login",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,"X-Fingerprint":t}})).json()).message==="valid"){this.token=e,this.isValidating=!1;const s=y(e);this.username=s.user,this.roleID=s.role}else localStorage.removeItem("jwt"),this.$router.replace("/")}catch{this.$router.replace("/")}},async logOut(){confirm("Вы уверены, что хотите выйти?")&&(await new Promise(e=>setTimeout(e,100)),localStorage.clear(),this.$router.replace("/"),await this.$router.replace("/"))}}},j={key:0,class:"main"},x={class:"header"},C={class:"nav"},B={class:"nav"},S={class:"container"},A={class:"wg"},E={class:"wg"};function G(e,t,u,d,s,r){const m=n("RouterLink"),_=n("profile"),h=n("invite"),p=n("WG"),f=n("authAdmin");return s.isValidating===!1?(l(),v("div",j,[o("div",x,[o("div",C,[i(m,{to:"/"},{default:w(()=>t[1]||(t[1]=[o("img",{class:"logo",src:I,width:"80"},null,-1)])),_:1}),t[2]||(t[2]=o("span",{class:"header-text"},[o("i",null," DarkSurf.ru ")],-1))]),o("div",B,[o("a",{href:"#",onClick:t[0]||(t[0]=N=>r.logOut())},t[3]||(t[3]=[o("img",{src:R},null,-1)]))])]),o("div",S,[o("div",A,[i(_),r.checkRole3(s.roleID)||r.checkRole2(s.roleID)?(l(),c(h,{key:0})):a("",!0)]),o("div",E,[i(p),r.checkRole3(s.roleID)?(l(),c(f,{key:0})):a("",!0)])]),t[4]||(t[4]=o("div",null,null,-1))])):a("",!0)}const L=k(D,[["render",G],["__scopeId","data-v-cab35e23"]]);export{L as default};
